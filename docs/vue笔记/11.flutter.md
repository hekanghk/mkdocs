### flutter

* flutter是一个UI SDK

* 大前端（三端）：移动  web  桌面
* 传统的前端单指web端
* flutter有统一大前端的趋势，在侵蚀原生的iOS/android开发
* flutter的优点：
  1. flutter内置material语言
  2. 快速：UI渲染速度很快
  3. 开发起来高效：只需要开发一套代码，多平台部署
  4. flutter开源
  5. 支持热重载
* 跨平台历史：webview    react native     

#### 开发流程

原生安卓开发：

1. java开发app
2. android框架翻译代码
3. 通过skia引擎为cpu/gpu提供数据
4. gpu渲染后显示

相比之下：RN：

1. js  css  redux等开发app通过js VM 等等 ，这一步性能消耗很大。

flutter性能高于安卓开发，是因为更新时skia能保持最新

### flutter原理：

#### 图像是如何显示出来的

* 每秒16帧，人眼就感到流畅

* 帧率和刷新率的不同：帧率指生产一帧，刷新率指的是屏幕显示一帧

* Skia为GPU提供数据，GPU负责绘制图像，绘制后，将数据放入Buffer中。显示器在刷新时，从buffer中取出图像，显示在屏幕上。这是一个典型的生产者-消费者模型。由GPU生产，屏幕显示（消费）

* double buffer 双重缓存。back buffer（GPU写入的目标）和frame buffer（显示器读取的来源）。

* 两个缓存间通过VSync信号配合。VSync做两件事：1.在一个屏幕刷新周期完成，产生VSync信号，将生产出的图像复制。2.在显示器显示完成后，VSync通知GPU绘制下一张图像

* Jank：画面停顿，甚至产生空白。双重缓存很容易出现这个现象。

* 三重缓存：多缓存一个buffer来备用，防止jank的产生

  ---

#### 渲染引擎skia

* 作用：**为GPU提供数据**

* Skia是flutter向GPU提供数据的途径。是一个C++写的开源图形库
* 安卓官方的**图像渲染引擎**是skia，所以ios的包会大一些 

#### flutter性能高在哪？

* 渲染闭环（循环点是vsync通知gpu开始下一轮循环）
* 相比之下，RN还需要js虚拟机/桥接/原生等过程
* flutter和rn的本质区别在于，rn是通过android和ios的系统组件进行渲染，而flutter是自己完成了组件的渲染。

#### flutter开发一般过程

1. 下载flutter的sdk
2. 配置flutter的环境变量  export PATH=$PATH:/flutter目录/bin
3. dart的环境变量
4. flutter create hello flutter
5. 配置ios/android模拟器：Xcode和Android Studio（flutter项目是要跑在模拟器上面的）

6. 配置镜像（更换国内的安装源）

